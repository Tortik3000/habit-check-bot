# Habit Check Bot

Telegram-бот для трекинга и анализа привычек.
Позволяет добавлять, удалять и отмечать привычки, а также отслеживать прогресс по дням через интерактивный календарь.

**Ссылка на бота:** [@obedUutnenko_bot](https://t.me/obedUutnenko_bot)

---

## Основной функционал

* Добавление и удаление привычек (`/add`, `/del`)
* Просмотр текущего чек-листа (`/get`)
* Просмотр прогресса по дням через календарь (`/cal`)

* Справка по доступным командам (`/help`)

---

## Технологический стек

| Компонент       | Технология / Версия                                | Назначение                    |
|-----------------|----------------------------------------------------| ----------------------------- |
| Язык            | Go 1.25                                            | Основной язык реализации      |
| Telegram API    | [go-telegram/bot](https://github.com/go-telegram/bot) | Работа с Telegram Bot API     |
| База данных     | PostgreSQL 17                                      | Хранение данных привычек      |
| Драйвер         | [pgx](https://github.com/jackc/pgx)                | Соединение с PostgreSQL       |
| Миграции        | [Goose](https://github.com/pressly/goose)          | Управление схемой БД          |
| Логирование     | [Zap](https://github.com/uber-go/zap)              | Структурированное логирование |
| Контейнеризация | Docker, Docker Compose                             | Оркестрация сервисов          |
| Автоматизация   | ansible 2.16                                       | Deploy |

---

## Команды бота

| Команда           | Описание                    |
| ----------------- | --------------------------- |
| `/start`          | Начало работы               |
| `/get`            | Показать список привычек    |
| `/add <название>` | Добавить новую привычку     |
| `/del <название>` | Удалить привычку            |
| `/cal`            | Открыть календарь прогресса |
| `/help`           | Справка и список команд     |

---

## Локальный запуск

### 1. Настройка окружения

Создайте файл `.env`:

```env
    TELEGRAM_BOT_TOKEN=<tg-token>
    POSTGRES_DB="bot"
    POSTGRES_USER="ed"
    POSTGRES_PASSWORD="1234567"
    POSTGRES_PORT="5432"
```

### 2. Запуск через Docker Compose

```bash
  docker-compose up -d
```
---


## CI/CD и деплой через Ansible

Процесс деплоя проекта автоматизирован с помощью **GitHub Actions** и **Ansible**.
Все чувствительные данные (переменные окружения, токены, пароли и т. д.) хранятся в зашифрованном виде с помощью **Ansible Vault**.



**Путь к файлам:**

```
bot_playbook/
├── group_vars/
│   └── vars.yml          # Переменные окружения
├── inventories/
│   └── bot.ini           # Переменыя для подключения к виртуальной машине
└── .vault_pass.txt       # Файл с паролем для шифрования
```

**Шифрование файла:**

```bash
  ansible-vault encrypt bot_playbook/group_vars/vars.yml  \
```

### Настройка подключения к удалённому серверу

Параметры подключения к виртуальной машине указываются в инвентарном файле `inventories/bot.ini`:

```ini
[all]
<vm-host> ansible_ssh_port=<ssh-port> ansible_ssh_user=<ssh-user>
```


### Деплой приложения вручную

```bash
  ansible-playbook -i inventories/bot.ini deploy.yml 
```


## ToDo :
- [ ] Получение списка привычек по выбранной дате
- [ ] Исправить кнопки для /add, /del